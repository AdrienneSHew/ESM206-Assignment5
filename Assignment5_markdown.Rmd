---
title: 'ESM 206 Assignment #5'
author: "Adrienne Hewitt, Shellby Johnson"
date: "November 27, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}

library(tidyverse)

Faculty_sal<-read_csv("faculty_salary.csv")
Faculty_sal

Grad_enroll<-read_csv("grad_enrollment.csv")
Grad_enroll

NonPD_mediansalary <- read_csv("Non_postdoc_mediansalary.csv")
NonPD_mediansalary

PD_mediansalary <- read_csv("Postdoc_mediansalary.csv")
PD_mediansalary

PHDs<-read_csv("PHDs_simple.csv")
PHDs



```

```{r}
#Is there a correlation between time and the number of males/females enrolled in grad school? Perform a linear regression to answer this question. 

##########################################################################################
#Step 1. Exploratory analysis; Does it look like describing the relationship between year and graduate enrollment using linear regression makes sense?

grad_enroll_plot<-ggplot(Grad_enroll, aes(x=Year, y=Total))+
  geom_point()+
  geom_point(data=Grad_enroll, aes(x=Year, y=Total_Males), color="blue")+
  geom_point(data=Grad_enroll, aes(x=Year, y=Total_Females), color="red")

grad_enroll_plot

#The data is fairly linear, so I will perform the linear regressions
#########################################################################################

male_grad_lm<-lm(Total_Males~Year, data=Grad_enroll)
male_grad_lm

female_grad_lm<-lm(Total_Females~Year, data=Grad_enroll)
female_grad_lm

##########################################################################################
#View model residuals (check for homoscedasticity, normality of the error distribution)

plot(male_grad_lm)

plot(female_grad_lm)
```


```{r}
#attempting to do exploratory graphs on median salaray data in order to determine normality....yeaaa, not sure how to get it to plot; will ask Allison or someone after lab


#exploratory histogram for male PD median salaries
PD_median_hist <- ggplot(PD_mediansalary, aes(x = Male))+
  geom_histogram( bins = 10)
PD_median_hist

# didn't do exploratory graphs for others because according to Allison, this is the test that needs to be done (from someone who went to office hours yesterday)

#paired, 2-sample MWU test (i.e. wilcoxon signed rank test) of post doc median salaries bwteen males and females

paired_MWU_PD <- wilcox.test(PD_mediansalary$Male, PD_mediansalary$Female, paired = TRUE)  
  
paired_MWU_PD

#paired, 2-sample MWU test (i.e. wilcoxon signed rank test) of nonpost doc median salaries bwteen males and females
paired_MWU_NonPD <- wilcox.test(NonPD_mediansalary$Male, NonPD_mediansalary$Female, paired = TRUE)  
  
paired_MWU_NonPD





```

